version: 2.1
jobs:
  build:
    docker:
      - image: integratedexperts/ci-builder
    steps:
      - checkout
      - run: composer validate --strict || true
      - run: .circleci/shellcheck.sh || true
      - run: .circleci/phpcs.sh || true
      - run: |
          if [ "${CIRCLE_BRANCH}" = "master" ] || [ "${CIRCLE_BRANCH}" = "develop" ] ; then
            curl -u "${CIRCLE_GOVCMS_SATIS_REBUILD}": -X POST --header "Content-Type: application/json" -d '{"parameters": {"trigger-description": "testing"}, "branch": "'"${CIRCLE_BRANCH}"'}' https://circleci.com/api/v2/project/github/govCMS/satis/pipeline
          fi
